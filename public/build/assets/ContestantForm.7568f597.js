import{$ as p}from"./jquery.f931fcee.js";import{l as O}from"./form-wizard-vue3.8c2d2911.js";import"./vue.7bf2bcd0.js";import{u as T}from"./vue-i18n.0ab86f4b.js";import{C as z}from"./contestant-levels.api.e6b50386.js";import{C as P,G as U,a as A}from"./city.api.07d82676.js";import{C as u}from"./contestants.api.fbd1af7d.js";import{u as b}from"./vue-toastification.f8d70964.js";import{_ as B}from"./app.ca0dd7db.js";import{a5 as i,o as f,Q as F,R as j,a as o,c as g,W as m,X as s,U as v,a0 as C}from"./@vue.ab32a142.js";import"./axios.04e16fa0.js";import"./@intlify.20ef3030.js";import"./lodash.4aca12d0.js";import"./vue-router.2be6d445.js";import"./js-cookie.31874410.js";import"./pinia.a7a730fe.js";import"./nprogress.e46cbde5.js";import"./element-plus.f4fb2d76.js";import"./lodash-es.2e433212.js";import"./@vueuse.4ac49989.js";import"./@element-plus.6e503c7c.js";import"./@ctrl.82a509e0.js";import"./dayjs.d96dc93a.js";import"./async-validator.1c690774.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@floating-ui.eae1f4bb.js";import"./js-base64.79f56a98.js";import"./pinia-plugin-persistedstate.f4ca662e.js";import"./vue-sweetalert2.891f877f.js";import"./@fortawesome.c9809c2b.js";import"./datatables.net-bs5.e18c8d11.js";import"./datatables.net.c69c83a2.js";import"./datatables.net-responsive-bs5.449cdb0d.js";import"./datatables.net-responsive.2a10a1b3.js";import"./jszip.2c79a5b0.js";import"./pdfmake.45c49c34.js";import"./datatables.net-buttons-bs5.1ab1a926.js";import"./datatables.net-buttons.5f6c1075.js";import"./@vueup.fdb4c0f7.js";import"./quill.2b7d1cee.js";import"./quill-delta.565c40c2.js";import"./fast-diff.40237be0.js";import"./lodash.clonedeep.14434a6c.js";import"./lodash.isequal.30baf809.js";const D={components:{Wizard:O},setup(){},data(){const{t:e}=T();return{currentTabIndex:0,is_last_step:!1,contestant:{id:"",first_name:"",second_name:"",last_name:"",birth_date:"",identity_proof:"national_id",national_id:"",passport:"",gender:"",contestant_level_ids:"",nationality:"",email:"",qualification:"",job:"",phone:"",password:"",confirmPassword:"",status:!0,country_id:"",governorate_id:"",city_id:"",main_address:"",additional_address:"",file_type:"profile_photo",file_id:"",step_no:1},file:{filePreview:"",fileName:""},contestantLevels:[],countries:[],governorates:[],cities:[],identityProofOptions:[{name:"national_id",label:e("pages.national_iD"),check:this.contestant?this.contestant.identity_proof==="national_id":!1},{name:"passport",label:e("pages.passport"),check:this.contestant?this.contestant.identity_proof==="passport":!1}],genderOptions:[{value:"male",label:e("pages.male"),check:this.contestant?this.contestant.gender==="male":!1},{value:"female",label:e("pages.female"),check:this.contestant?this.contestant.gender==="female":!1}],countryCodeOptions:[{value:"+20",label:"+20"},{value:"+965",label:"+965"},{value:"+966",label:"+966"}]}},methods:{onChangeCurrentTab(e){this.currentTabIndex=e},onNextTab(e){this.createOrUpdate(this.contestant,e)},onBackTab(e){this.currentTabIndex=e,this.is_last_step=!1,this.contestant.step_no=this.contestant.step_no-1,setTimeout(function(){p(".fw-list-progress").not(".fw-list-progress-active").parent().next().find(".fw-list-wrapper-icon").removeClass("fw-step-active")},100)},wizardCompleted(){this.is_last_step=!0,this.createOrUpdate(this.contestant,2)},getContestantLevels(){z.list().then(({data:e})=>{this.contestantLevels=e.data}).catch(e=>{console.log(e)})},getCountries(){P.list().then(({data:e})=>{this.countries=e.data}).catch(e=>{console.log(e)})},getGovernorates(){let e={country:this.contestant.country_id};U.list(e).then(({data:r})=>{this.governorates=r.data}).catch(r=>{console.log(r)})},getCities(){let e={governorate:this.contestant.governorate_id};A.list(e).then(({data:r})=>{this.cities=r.data}).catch(r=>{console.log(r)})},getContestant(){this.$route.params.id&&u.get(this.$route.params.id,null,null).then(({data:e})=>{this.contestant=e.data,this.contestant.file.filePreview=e.data.file_url}).catch(e=>{console.log(e)})},getUploadedData(e){this.file.filePreview=e.previewBase64,this.file.fileName=e.name;let r=new FormData;for(var n=e.previewBase64.split(","),y=n[0].match(/:(.*?);/)[1],t=atob(n[1]),l=t.length,h=new Uint8Array(l);l--;)h[l]=t.charCodeAt(l);let a=new File([h],e.name,{type:y});r.append("profile_photo",a),r.append("type","profile_photo"),u.upload(r).then(({data:d})=>{this.contestant.file_id=d.id,this.contestant.file_type=d.type,console.log(d)}).catch(d=>{console.log(d)})},createOrUpdate(e,r){r===1&&(this.contestant.id===""&&u.store(this.contestant).then(({data:n})=>{b().success(this.$t("messages.success")),this.currentTabIndex=r,this.contestant.step_no=r+1,this.contestant.id=n.data.id,setTimeout(function(){p(".fw-list-progress").hasClass("fw-list-progress-active")&&p(".fw-list-progress-active").parent("li").next("li").find(".fw-list-wrapper-icon").addClass("fw-step-active")},100)}).catch(n=>{console.log(n),this.formErrors=n.response.data.errors}),this.contestant.id!==""&&u.update(this.contestant).then(({data:n})=>{b().success(this.$t("messages.success")),this.currentTabIndex=r,this.contestant.step_no=r+1}).catch(n=>{console.log(n),this.formErrors=n.response.data.errors})),r===2&&u.updateStep(this.contestant).then(({data:n})=>{b().success(this.$t("messages.success")),this.$router.push({path:"/contestants"})}).catch(n=>{console.log(n),this.formErrors=n.response.data.errors})},checkActiveStep(){(this.currentTabIndex===1||this.contestant.step_no===2)&&(this.currentTabIndex=2,setTimeout(function(){p(".fw-list-progress").hasClass("fw-list-progress-active")&&p(".fw-list-progress-active").parent("li").next("li").find(".fw-list-wrapper-icon").addClass("fw-step-active")},100))}},mounted(){this.getContestantLevels(),this.getCountries(),this.$route.params.id&&this.getGovernorates(),this.$route.params.id&&this.getCities(),this.$route.params.id&&this.getContestant(),this.checkActiveStep()},computed:{mappedIdentityProofOptions(){return this.identityProofOptions.map(e=>({...e,check:e.name===this.contestant.identity_proof}))},mappedGenderOptions(){return this.genderOptions.map(e=>({...e,check:e.value===this.contestant.gender}))}}},N={key:0},G={class:"row"},L={class:"col-md-4"},q={class:"form-label"},S={class:"row"},W={class:"col-md-4"},R={class:"col-md-4"},V={class:"col-md-4"},M={class:"col-md-4"},Q={class:"col-md-4"},X={class:"mb-3"},H={class:"form-label"},J={class:"control-bg d-md-flex align-items-center flex-wrap"},K={key:0,class:"col-md-4"},Y={key:1,class:"col-md-4"},Z={class:"col-md-4"},x={class:"col-md-4"},$={class:"col-md-4"},ee={class:"col-md-4"},te={class:"col-md-4"},oe={class:"col-md-4"},re={class:"col-md-4"},se={class:"col-md-4"},ne={class:"col-md-4"},ae={class:"col-md-4"},le={class:"col-md-4"},ie={class:"mb-3 d-flex align-items-center flex-wrap h-100"},de={class:"form-label me-2"},ce={class:"d-flex align-items-cenetr pt-4 justify-content-end"},me={key:1},pe={class:"row"},ue={class:"col-md-4"},fe={class:"col-md-4"},he={class:"col-md-4"},_e={class:"col-md-4"},ge={class:"col-md-4"},ve={class:"d-flex align-items-cenetr pt-4 justify-content-end"};function be(e,r,n,y,t,l){const h=i("FormImageUploader"),a=i("form-input"),d=i("form-date-select"),w=i("form-radio-group"),c=i("form-select"),I=i("form-switcher"),E=i("form-text-area"),k=i("Wizard");return f(),F(k,{startIndex:t.currentTabIndex,"next-button":{text:e.$t("pagination.next"),icon:"check",hideIcon:!0,hideText:!1},"back-button":{text:e.$t("pagination.prev"),hideIcon:!0,hideText:!1},"done-button":{text:e.$t("forms.save"),hideIcon:!0},hideButtons:"","custom-tabs":[{title:e.$t("pages.contestant_main_info")},{title:e.$t("pages.address_info")}],onChange:l.onChangeCurrentTab},{default:j(()=>[o("form",null,[t.currentTabIndex===0&&(this.contestant.step_no===1||this.contestant.step_no===null)?(f(),g("div",N,[o("div",G,[o("div",L,[o("label",q,m(e.$t("pages.profile_pic")),1),s(h,{name:"profile_photo",accept:"png,jpg,jpeg",onFileUploaded:r[0]||(r[0]=_=>l.getUploadedData(_)),src:this.file.filePreview?this.file.filePreview:this.contestant.file_url,size:2,limit:1,width:"w-100"},null,8,["src"])])]),o("div",S,[o("div",W,[s(a,{id:"first-name",label:"pages.first_name",type:"text",model:this.contestant,name:"first_name",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",R,[s(a,{id:"second-name",label:"pages.second_name",type:"text",model:t.contestant,name:"second_name",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",V,[s(a,{id:"last-name",label:"pages.last_name",type:"text",model:t.contestant,name:"last_name",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",M,[s(d,{label:"pages.dob",model:t.contestant,name:"birth_date",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",Q,[o("div",X,[o("label",H,m(e.$t("pages.identity_proof")),1),o("div",J,[s(w,{options:t.identityProofOptions,model:t.contestant,name:"identity_proof"},null,8,["options","model"])])])]),t.contestant.identity_proof==="national_id"?(f(),g("div",K,[s(a,{id:"national_id",label:"pages.national_iD",type:"number",model:t.contestant,name:"national_id",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])])):v("v-if",!0),t.contestant.identity_proof==="passport"?(f(),g("div",Y,[s(a,{id:"passport",label:"pages.passport",type:"text",model:t.contestant,name:"passport",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])])):v("v-if",!0),o("div",Z,[s(c,{title:"pages.type",label:"name",name:"gender",onClearErrors:e.clearInput,model:t.contestant,myOptions:t.genderOptions,errors:e.formErrors},null,8,["onClearErrors","model","myOptions","errors"])]),o("div",x,[s(c,{title:"pages.level",label:"name",name:"contestant_level_ids",multiple:"",onClearErrors:e.clearInput,model:t.contestant,myOptions:t.contestantLevels,"label-field":"name_localized","value-field":"id",errors:e.formErrors},null,8,["onClearErrors","model","myOptions","errors"])]),o("div",$,[s(a,{id:"nationality",label:"pages.nationality",type:"text",model:t.contestant,name:"nationality",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",ee,[s(a,{id:"email",label:"pages.email",type:"email",model:t.contestant,name:"email",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",te,[s(a,{id:"educational-qualification",label:"pages.educational_qualification",type:"text",model:t.contestant,name:"qualification",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",oe,[s(a,{id:"basic-job",label:"pages.basic_job",type:"text",model:t.contestant,name:"job",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",re,[s(c,{title:"pages.country_code",label:"name",name:"country_code",onClearErrors:e.clearInput,model:t.contestant,myOptions:t.countryCodeOptions,"label-field":"label","value-field":"value",errors:e.formErrors},null,8,["onClearErrors","model","myOptions","errors"])]),o("div",se,[s(a,{id:"phone",label:"pages.phone",type:"tel",model:t.contestant,name:"phone",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",ne,[s(a,{id:"password",label:"pages.password",type:"password",model:t.contestant,name:"password",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",ae,[s(a,{id:"password-confirm",label:"pages.password_confirmation",type:"password",model:t.contestant,name:"password_confirmation",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",le,[o("div",ie,[o("label",de,m(e.$t("pages.status")),1),s(I,{id:"status",model:t.contestant,name:"status",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])])])]),o("div",ce,[o("button",{type:"button",onClick:r[1]||(r[1]=C(_=>l.onNextTab(1,0),["prevent"])),class:"btn btn-babyblue text-white fw-bold"},m(e.$t("pagination.next")),1)])])):v("v-if",!0),t.currentTabIndex===1||this.contestant.step_no===2?(f(),g("div",me,[o("div",pe,[o("div",ue,[s(c,{title:"pages.country",label:"name",name:"country_id",onClearErrors:e.clearInput,model:t.contestant,myOptions:t.countries,errors:e.formErrors,"label-field":"name_localized","value-field":"id",onChange:l.getGovernorates},null,8,["onClearErrors","model","myOptions","errors","onChange"])]),o("div",fe,[s(c,{title:"pages.governorate",label:"name",name:"governorate_id",onClearErrors:e.clearInput,model:t.contestant,myOptions:t.governorates,errors:e.formErrors,"label-field":"name_localized","value-field":"id",onChange:l.getCities},null,8,["onClearErrors","model","myOptions","errors","onChange"])]),o("div",he,[s(c,{title:"pages.city",label:"name",name:"city_id",onClearErrors:e.clearInput,model:t.contestant,myOptions:t.cities,errors:e.formErrors,"label-field":"name_localized","value-field":"id"},null,8,["onClearErrors","model","myOptions","errors"])]),o("div",_e,[s(E,{id:"main-address",label:"pages.main_address",model:t.contestant,name:"main_address",rows:4,errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),o("div",ge,[s(E,{id:"alternative-address",label:"pages.alternative_address",model:t.contestant,name:"additional_address",rows:4,errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])])]),o("div",ve,[o("button",{onClick:r[2]||(r[2]=C(_=>l.wizardCompleted(),["prevent"])),type:"button",class:"btn btn-babyblue text-white fw-bold last_step"},m(e.$t("forms.save")),1),o("button",{type:"button",class:"btn btn-light text-grayClr fw-bold ms-2",onClick:r[3]||(r[3]=C(_=>l.onBackTab(0,1),["prevent"]))},m(e.$t("pagination.prev")),1)])])):v("v-if",!0)])]),_:1},8,["startIndex","next-button","back-button","done-button","custom-tabs","onChange"])}const pt=B(D,[["render",be],["__file","E:/Roqay/Rasekhon/rasekhon/resources/app/views/contestants/ContestantForm.vue"]]);export{pt as default};
