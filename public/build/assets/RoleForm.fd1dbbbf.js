import{$ as t}from"./jquery.f931fcee.js";import{R as k}from"./role.api.5a5c0e9b.js";import{B as T,_ as C,a as P}from"./app.ca0dd7db.js";import"./vue.7bf2bcd0.js";import{a5 as d,o as n,Q as $,R,a as r,W as c,c as m,a8 as v,S,af as w,U as b,F as x,X as h,a0 as B}from"./@vue.ab32a142.js";import{u as y}from"./vue-toastification.f8d70964.js";import"./axios.04e16fa0.js";import"./lodash.4aca12d0.js";import"./vue-router.2be6d445.js";import"./js-cookie.31874410.js";import"./pinia.a7a730fe.js";import"./nprogress.e46cbde5.js";import"./element-plus.f4fb2d76.js";import"./lodash-es.2e433212.js";import"./@vueuse.4ac49989.js";import"./@element-plus.6e503c7c.js";import"./@ctrl.82a509e0.js";import"./dayjs.d96dc93a.js";import"./async-validator.1c690774.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@floating-ui.eae1f4bb.js";import"./vue-i18n.0ab86f4b.js";import"./@intlify.20ef3030.js";import"./js-base64.79f56a98.js";import"./pinia-plugin-persistedstate.f4ca662e.js";import"./vue-sweetalert2.891f877f.js";import"./@fortawesome.c9809c2b.js";import"./datatables.net-bs5.e18c8d11.js";import"./datatables.net.c69c83a2.js";import"./datatables.net-responsive-bs5.449cdb0d.js";import"./datatables.net-responsive.2a10a1b3.js";import"./jszip.2c79a5b0.js";import"./pdfmake.45c49c34.js";import"./datatables.net-buttons-bs5.1ab1a926.js";import"./datatables.net-buttons.5f6c1075.js";import"./@vueup.fdb4c0f7.js";import"./quill.2b7d1cee.js";import"./quill-delta.565c40c2.js";import"./fast-diff.40237be0.js";import"./lodash.clonedeep.14434a6c.js";import"./lodash.isequal.30baf809.js";class E extends T{static get entity(){return"permissions"}}const F={name:"PermissionCard",props:{modelValue:{type:[Object],required:!0},permissions:{type:Array,default:[]},groupTitle:{type:String,default:null},selectedPermissions:{type:Array,default:[]}},data(){},computed:{allSelected(){return this.modelValue!==void 0&&this.modelValue[this.groupTitle]&&this.modelValue[this.groupTitle].length===this.permissions.length}},created(){this.modelValue!==void 0&&!this.modelValue[this.groupTitle]&&(this.modelValue[this.groupTitle]=[])},methods:{selectAll(e){if(e.target.checked)return this.permissions.forEach(s=>this.modelValue[this.groupTitle].push(s.id));t(".select_all_permissions").prop("checked",!1),this.modelValue[this.groupTitle]=[],this.checkIfSelectAll(".group_title_checkboxes")},checkIfSelectAll(e){t(e).click(function(){t(e+":checked").length===t(e).length?t(".select_all_permissions").prop("checked",!0):t(".select_all_permissions").prop("checked",!1)})}}},U={class:"form-check bg-controlBg p-2 rounded mb-2"},I=["id","checked"],q=["for"],N={class:"px-2"},j=["id","value"],D=["for"],M={key:0},L={key:1};function O(e,s,o,V,a,l){const f=d("card");return n(),$(f,{class:"p-2"},{default:R(()=>[r("div",U,[r("input",{class:"form-check-input me-2 ms-0 group_title_checkboxes",type:"checkbox",id:`${o.groupTitle}-checkbox`,checked:l.allSelected,onClick:s[0]||(s[0]=i=>l.selectAll(i))},null,8,I),r("label",{class:"form-check-label text-secondary fw-bold",for:`${o.groupTitle}-checkbox`},c(e.$t(`role_permissions.${o.groupTitle}`)),9,q)]),r("div",N,[(n(!0),m(x,null,v(o.permissions,(i,_)=>(n(),m("div",{class:"form-check",key:_},[S(r("input",{class:"form-check-input me-2 permission_checkbox",type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=u=>o.modelValue[o.groupTitle]=u),id:`checkbox-${i.id}`,value:i.id,onClick:s[2]||(s[2]=u=>l.checkIfSelectAll(".permission_checkbox"))},null,8,j),[[w,o.modelValue[o.groupTitle]]]),r("label",{class:"form-check-label",for:`checkbox-${i.id}`},[o.groupTitle!=="Report"?(n(),m("span",M,c(e.$t(`role_permissions.${i.name.split("_")[0]}`))+" "+c(e.$t(`role_permissions.${o.groupTitle}`)),1)):b("v-if",!0),o.groupTitle==="Report"?(n(),m("span",L,c(e.$t(`role_permissions.${i.name}`)),1)):b("v-if",!0)],8,D)]))),128))])]),_:1})}const Q=C(F,[["render",O],["__file","E:/Roqay/Rasekhon/rasekhon/resources/app/views/roles/PermissionCardComponent.vue"]]),W={name:"RoleForm",components:{CancelButton:P,PermissionCard:Q},data(){return{isUpdateForm:!!this.$route.params.id,isReadonly:!1,form:{name:"",role_permissions:{}},system_permissions:[],userRolePermissionCounts:0,allRolesPermissionsCounts:[]}},methods:{getRole(){return k.get({id:this.$route.params.id}).then(e=>{const s=e.data.data.role;this.form.id=s.id,this.form.name=s.name,this.form.role_permissions=s.permissions,this.userRolePermissionCounts=s.permissions_counts,(s.id==1||s.id==2)&&(this.isReadonly=!0)})},getSystemPermissions(){return E.list().then(e=>{this.system_permissions=e.data;for(const s in e.data)this.allRolesPermissionsCounts.push(s)})},submit(){return this.isUpdateForm?k.update(this.form).then(e=>{y().success(e.data.message),this.$router.back()}).catch(e=>{this.formErrors=e.response.data.errors}):k.store(this.form).then(e=>{y().success(e.data.message),this.$router.back()}).catch(e=>{this.formErrors=e.response.data.errors})},selectAllPermission(e){e.target.checked?t(".group_title_checkboxes").each(function(){t(this).prop("checked")?t(this).prop("checked",!0):(t(this).trigger("click"),t(this).prop("checked",!0))}):t(".group_title_checkboxes").each(function(){t(this).trigger("click"),t(this).prop("checked",!1)})}},mounted(){this.isUpdateForm&&this.getRole(),this.getSystemPermissions()},computed:{isAllSelected(){return this.userRolePermissionCounts===this.allRolesPermissionsCounts.length}}},X={class:"d-flex flex-column"},z={class:"form-check bg-controlBg p-2 rounded mb-2"},G=["checked"],H={class:"form-check-label text-secondary fw-bold",for:"selectAll"},J={class:"mb-3 row"},K={class:"d-flex align-items-cenetr pt-4 justify-content-end mb-4"};function Y(e,s,o,V,a,l){const f=d("form-input"),i=d("card"),_=d("permission-card"),u=d("cancel-button");return n(),m("form",X,[h(i,null,{body:R(()=>[h(f,{label:"pages.name",type:"text",model:a.form,name:"name",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"]),r("div",z,[r("input",{class:"form-check-input me-2 ms-0 select_all_permissions",type:"checkbox",id:"selectAll",checked:l.isAllSelected,onClick:s[0]||(s[0]=p=>l.selectAllPermission(p))},null,8,G),r("label",H,c(e.$t("role_permissions.select_all")),1)])]),_:1}),r("div",J,[(n(!0),m(x,null,v(this.system_permissions,(p,g)=>(n(),m("div",{class:"col-md-4",key:g},[h(_,{permissions:p,"group-title":g,modelValue:a.form.role_permissions,"onUpdate:modelValue":s[1]||(s[1]=A=>a.form.role_permissions=A),"update-form":a.isUpdateForm},null,8,["permissions","group-title","modelValue","update-form"])]))),128))]),r("div",K,[r("button",{type:"button",onClick:s[2]||(s[2]=B((...p)=>l.submit&&l.submit(...p),["prevent"])),class:"btn btn-babyblue text-white fw-bold"},c(e.$t("forms.save")),1),h(u)])])}const Le=C(W,[["render",Y],["__file","E:/Roqay/Rasekhon/rasekhon/resources/app/views/roles/RoleForm.vue"]]);export{Le as default};
