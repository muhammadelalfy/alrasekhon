import{$ as c}from"./jquery.f931fcee.js";import{l as O}from"./form-wizard-vue3.8c2d2911.js";import{u as k}from"./vue-i18n.0ab86f4b.js";import{C as T,G as F,a as A}from"./city.api.07d82676.js";import{u as v}from"./vue-toastification.f8d70964.js";import{_ as z,F as B}from"./app.ca0dd7db.js";import{U as u}from"./user.api.fb936cc2.js";import"./vue.7bf2bcd0.js";import{a5 as n,o as f,Q as P,R as j,a as r,c as g,W as p,X as t,U as b,a0 as U}from"./@vue.ab32a142.js";import"./axios.04e16fa0.js";import"./@intlify.20ef3030.js";import"./lodash.4aca12d0.js";import"./vue-router.2be6d445.js";import"./js-cookie.31874410.js";import"./pinia.a7a730fe.js";import"./nprogress.e46cbde5.js";import"./element-plus.f4fb2d76.js";import"./lodash-es.2e433212.js";import"./@vueuse.4ac49989.js";import"./@element-plus.6e503c7c.js";import"./@ctrl.82a509e0.js";import"./dayjs.d96dc93a.js";import"./async-validator.1c690774.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@floating-ui.eae1f4bb.js";import"./js-base64.79f56a98.js";import"./pinia-plugin-persistedstate.f4ca662e.js";import"./vue-sweetalert2.891f877f.js";import"./@fortawesome.c9809c2b.js";import"./datatables.net-bs5.e18c8d11.js";import"./datatables.net.c69c83a2.js";import"./datatables.net-responsive-bs5.449cdb0d.js";import"./datatables.net-responsive.2a10a1b3.js";import"./jszip.2c79a5b0.js";import"./pdfmake.45c49c34.js";import"./datatables.net-buttons-bs5.1ab1a926.js";import"./datatables.net-buttons.5f6c1075.js";import"./@vueup.fdb4c0f7.js";import"./quill.2b7d1cee.js";import"./quill-delta.565c40c2.js";import"./fast-diff.40237be0.js";import"./lodash.clonedeep.14434a6c.js";import"./lodash.isequal.30baf809.js";const S={components:{FormRadioGroup:B,Wizard:O},data(){const{t:e}=k();return{currentTabIndex:0,is_last_step:!1,User:{id:"",first_name:"",second_name:"",last_name:"",gender:"",email_status:1,phone_status:1,nationality:"",email:"",qualifications:"",main_job:"",phone:"",password:"",password_confirmation:"",lang:"",identity_proof:"national_id",status:!0,country_id:"",governorate:"",city_id:"",address:"",file_id:"",file_url:"",alternative_address:"",birth_date:"",type:"",step_no:1},file:{filePreview:"",fileName:""},identityProofOptions:[{name:"national_id",label:e("pages.national_iD"),check:this.User?this.User.identity_proof==="national_id":!1},{name:"passport",label:e("pages.passport"),check:this.User?this.User.identity_proof==="passport":!1}],langOptions:[{value:"ar",label:e("ar"),selected:this.User?this.User.lang==="ar":!1},{value:"en",label:e("en"),selected:this.User?this.User.lang==="en":!1}],phoneStatusOptions:[{value:1,label:e("pages.active"),selected:this.User?this.User.phone_status===1:!1},{value:0,label:e("pages.notActive"),selected:this.User?this.User.phone_status===0:!1}],typeOptions:[{value:"male",label:e("pages.male"),selected:this.User?this.User.gender==="male":!1},{value:"female",label:e("pages.female"),selected:this.User?this.User.gender==="female":!1}],emailStatusOptions:[{value:1,label:e("pages.active"),selected:this.User?this.User.email_status===1:!1},{value:0,label:e("pages.notActive"),selected:this.User?this.User.email_status===0:!1}],countries:[],governorates:[],cities:[]}},methods:{onChangeCurrentTab(e){this.currentTabIndex=e},onNextTab(e){this.createOrUpdate(this.User,e)},onBackTab(e){this.currentTabIndex=e,this.User.is_last_step=!1,this.User.step_no=this.User.step_no-1,setTimeout(function(){c(".fw-list-progress").not(".fw-list-progress-active").parent().next().find(".fw-list-wrapper-icon").removeClass("fw-step-active")},100)},wizardCompleted(){this.User.is_last_step=!0,this.createOrUpdate(this.User,2)},createOrUpdate(e,o){o===1&&(this.User.id===""&&u.store(this.User).then(({data:l})=>{v().success(this.$t("messages.success")),this.currentTabIndex=o,this.User.step_no=o+1,this.User.id=l.data.id,setTimeout(function(){c(".fw-list-progress").hasClass("fw-list-progress-active")&&c(".fw-list-progress-active").parent("li").next("li").find(".fw-list-wrapper-icon").addClass("fw-step-active")},100)}).catch(l=>{console.log(l),this.formErrors=l.response.data.errors}),this.User.id!==""&&u.update(this.User).then(({data:l})=>{v().success(this.$t("messages.success")),this.currentTabIndex=o,this.User.step_no=o+1}).catch(l=>{this.formErrors=l.response.data.errors})),o===2&&u.updateStep(this.User).then(({data:l})=>{v().success(this.$t("messages.success")),l.step_no||this.$router.push({path:"/users"})}).catch(l=>{console.log(l),this.formErrors=l.response.data.errors})},checkActiveStep(){(this.currentTabIndex===1||this.User.step_no===2)&&(this.currentTabIndex=2,setTimeout(function(){c(".fw-list-progress").hasClass("fw-list-progress-active")&&c(".fw-list-progress-active").parent("li").next("li").find(".fw-list-wrapper-icon").addClass("fw-step-active")},100))},getCountries(){T.list().then(({data:e})=>{this.countries=e.data}).catch(e=>{console.log(e)})},getGovernorates(){let e={country:this.User.country_id};F.list(e).then(({data:o})=>{this.governorates=o.data}).catch(o=>{console.log(o)})},getCities(){let e={governorate:this.User.governorate_id};A.list(e).then(({data:o})=>{this.cities=o.data}).catch(o=>{console.log(o)})},getUser(){this.$route.params.id&&u.get(this.$route.params.id,null,null).then(({data:e})=>{this.User=e.data,this.User.file.filePreview=e.data.file_url,console.log(this.User)}).catch(e=>{console.log(e)})},getUploadedData(e){this.file.filePreview=e.previewBase64,this.file.fileName=e.name;let o=new FormData;for(var l=e.previewBase64.split(","),y=l[0].match(/:(.*?);/)[1],s=atob(l[1]),i=s.length,h=new Uint8Array(i);i--;)h[i]=s.charCodeAt(i);let a=new File([h],e.name,{type:y});o.append("profile_photo",a),o.append("type","profile_photo"),u.upload(o).then(({data:m})=>{this.User.file_id=m.id,this.User.file_type=m.type,console.log(m)}).catch(m=>{console.log(m)})}},computed:{mappedIdentityProofOptions(){return this.identityProofOptions.map(e=>({...e,check:e.name===this.User.identity_proof}))}},mounted(){this.getCountries(),this.$route.params.id&&this.getGovernorates(),this.$route.params.id&&this.getCities(),this.$route.params.id&&this.getUser(),this.checkActiveStep()}},D={key:0},N={class:"row"},G={class:"col-md-4"},q={class:"form-label"},R={class:"row"},W={class:"col-md-4"},V={class:"col-md-4"},M={class:"col-md-4"},Q={class:"col-md-4"},X={class:"col-md-4"},H={class:"mb-3"},J={class:"form-label"},K={class:"control-bg d-md-flex align-items-center flex-wrap"},L={key:0,class:"col-md-4"},Y={key:1,class:"col-md-4"},Z={class:"col-md-4"},x={class:"col-md-4"},$={class:"col-md-4"},ee={class:"col-md-4"},re={class:"col-md-4"},se={class:"col-md-4"},oe={class:"col-md-4"},te={class:"col-md-4"},le={class:"col-md-4"},ae={class:"col-md-4"},ie={class:"col-md-4"},ne={class:"col-md-4"},me={class:"mb-3 d-flex align-items-center flex-wrap h-100"},de={class:"form-label me-2"},pe={class:"d-flex align-items-cenetr pt-4 justify-content-end"},ce={key:1},ue={class:"row"},fe={class:"col-md-4"},he={class:"col-md-4"},_e={class:"col-md-4"},ge={class:"col-md-4"},be={class:"col-md-4"},ve={class:"d-flex align-items-cenetr pt-4 justify-content-end"};function Ue(e,o,l,y,s,i){const h=n("FormImageUploader"),a=n("form-input"),m=n("form-date-select"),E=n("form-radio-group"),d=n("form-select"),w=n("form-switcher"),C=n("form-text-area"),I=n("Wizard");return f(),P(I,{startIndex:s.currentTabIndex,"next-button":{text:e.$t("pagination.next"),icon:"check",hideIcon:!0,hideText:!1},"back-button":{text:e.$t("pagination.prev"),hideIcon:!0,hideText:!1},"done-button":{text:e.$t("forms.save"),hideIcon:!0},hideButtons:"","custom-tabs":[{title:e.$t("pages.mod_main_info")},{title:e.$t("pages.address_info")}],onChange:i.onChangeCurrentTab},{default:j(()=>[r("form",null,[s.currentTabIndex===0&&(this.User.step_no===1||this.User.step_no===null)?(f(),g("div",D,[r("div",N,[r("div",G,[r("label",q,p(e.$t("pages.profile_pic")),1),t(h,{name:"profile_photo",accept:"png,jpg,jpeg",onFileUploaded:o[0]||(o[0]=_=>i.getUploadedData(_)),src:this.file.filePreview?this.file.filePreview:this.User.file_url,size:2,limit:1,width:"w-100"},null,8,["src"])])]),r("div",R,[r("div",W,[t(a,{id:"first-name",label:"pages.first_name",type:"text",model:s.User,name:"first_name",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",V,[t(a,{id:"second-name",label:"pages.second_name",type:"text",model:s.User,name:"second_name",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",M,[t(a,{id:"last-name",label:"pages.last_name",type:"text",model:s.User,name:"last_name",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",Q,[t(m,{label:"pages.dob",model:s.User,name:"birth_date",errors:e.formErrors},null,8,["model","errors"])]),r("div",X,[r("div",H,[r("label",J,p(e.$t("pages.identity_proof")),1),r("div",K,[t(E,{options:s.identityProofOptions,model:s.User,name:"identity_proof"},null,8,["options","model"])])])]),s.User.identity_proof==="national_id"?(f(),g("div",L,[t(a,{id:"national_id",label:"pages.national_iD",type:"number",model:s.User,name:"national_id",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])])):b("v-if",!0),s.User.identity_proof==="passport"?(f(),g("div",Y,[t(a,{id:"passport",label:"pages.passport",type:"text",model:s.User,name:"passport",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])])):b("v-if",!0),r("div",Z,[t(d,{title:"pages.type",label:"name",name:"gender",onClearErrors:e.clearInput,model:s.User,myOptions:s.typeOptions,errors:e.formErrors,"label-field":"label","value-field":"value"},null,8,["onClearErrors","model","myOptions","errors"])]),r("div",x,[t(a,{id:"nationality",label:"pages.nationality",type:"text",model:s.User,name:"nationality",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",$,[t(a,{id:"email",label:"pages.email",type:"email",model:s.User,name:"email","value-field":"value","label-field":"label",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",ee,[t(a,{id:"educational-qualification",label:"pages.educational_qualification",type:"text",model:s.User,name:"qualifications",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",re,[t(d,{title:"pages.email_status",label:"name",name:"email_status",onClearErrors:e.clearInput,model:s.User,myOptions:s.emailStatusOptions,errors:e.formErrors,"label-field":"label","value-field":"value"},null,8,["onClearErrors","model","myOptions","errors"])]),r("div",se,[t(a,{id:"basic-job",label:"pages.basic_job",type:"text",model:s.User,name:"main_job",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",oe,[t(a,{id:"phone",label:"pages.phone",value:"+",type:"tel",model:s.User,name:"phone",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",te,[t(d,{title:"pages.phone_status",label:"name",name:"phone_status",onClearErrors:e.clearInput,model:s.User,myOptions:s.phoneStatusOptions,"label-field":"label","value-field":"value",errors:e.formErrors},null,8,["onClearErrors","model","myOptions","errors"])]),r("div",le,[t(a,{id:"password",label:"pages.password",type:"password",model:s.User,name:"password",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",ae,[t(a,{id:"password-confirm",label:"pages.password_confirmation",type:"password",model:s.User,name:"password_confirmation",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",ie,[t(d,{title:"pages.lang",label:"name",name:"lang",onClearErrors:e.clearInput,model:s.User,myOptions:s.langOptions,errors:e.formErrors,"value-field":"value","label-field":"label"},null,8,["onClearErrors","model","myOptions","errors"])]),r("div",ne,[r("div",me,[r("label",de,p(e.$t("pages.status")),1),t(w,{id:"status",model:s.User,name:"status",errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])])])]),r("div",pe,[r("button",{type:"button",onClick:o[1]||(o[1]=U(_=>i.onNextTab(1,0),["prevent"])),class:"btn btn-babyblue text-white fw-bold"},p(e.$t("pagination.next")),1)])])):b("v-if",!0),s.currentTabIndex===1||this.User.step_no===2?(f(),g("div",ce,[r("div",ue,[r("div",fe,[t(d,{title:"pages.country",label:"name","label-field":"name_localized",name:"country_id",onClearErrors:e.clearInput,model:s.User,myOptions:this.countries,"value-field":"id",errors:e.formErrors,onChange:i.getGovernorates},null,8,["onClearErrors","model","myOptions","errors","onChange"])]),r("div",he,[t(d,{title:"pages.governorate",label:"name","label-field":"name_localized","value-field":"id",name:"governorate_id",onClearErrors:e.clearInput,model:s.User,myOptions:this.governorates,errors:e.formErrors,onChange:i.getCities},null,8,["onClearErrors","model","myOptions","errors","onChange"])]),r("div",_e,[t(d,{title:"pages.city",label:"name","label-field":"name_localized","value-field":"id",name:"city_id",onClearErrors:e.clearInput,model:s.User,myOptions:this.cities,errors:e.formErrors},null,8,["onClearErrors","model","myOptions","errors"])]),r("div",ge,[t(C,{id:"main-address",label:"pages.main_address",model:s.User,name:"address",rows:4,errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])]),r("div",be,[t(C,{id:"alternative-address",label:"pages.alternative_address",model:s.User,name:"alternative_address",rows:4,errors:e.formErrors,onClearErrors:e.clearInput},null,8,["model","errors","onClearErrors"])])]),r("div",ve,[r("button",{onClick:o[2]||(o[2]=U(_=>i.wizardCompleted(),["prevent"])),type:"button",class:"btn btn-babyblue text-white fw-bold"},p(e.$t("forms.save")),1),r("button",{type:"button",class:"btn btn-light text-grayClr fw-bold ms-2",onClick:o[3]||(o[3]=U(_=>i.onBackTab(0,1),["prevent"]))},p(e.$t("pagination.prev")),1)])])):b("v-if",!0)])]),_:1},8,["startIndex","next-button","back-button","done-button","custom-tabs","onChange"])}const cr=z(S,[["render",Ue],["__file","E:/Roqay/Rasekhon/rasekhon/resources/app/views/users/UserForm.vue"]]);export{cr as default};
